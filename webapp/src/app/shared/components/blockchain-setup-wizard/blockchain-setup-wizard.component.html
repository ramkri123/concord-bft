<form [formGroup]="form">
<clr-wizard #wizard [(clrWizardOpen)]="isOpen" (clrWizardOnFinish)="onSubmit()" (clrWizardOnCancel)="resetFragment()">
  <clr-wizard-title>Deploy</clr-wizard-title>

  <clr-wizard-button [type]="'cancel'">Cancel</clr-wizard-button>
  <clr-wizard-button [type]="'previous'">Back</clr-wizard-button>
  <clr-wizard-button [type]="'next'">Next</clr-wizard-button>
  <clr-wizard-button [type]="'finish'">Finish</clr-wizard-button>

  <clr-wizard-page #blockConsortiumPage
                   [clrWizardPageNextDisabled]="!form.controls.blockchain.valid || !form.controls.consortium.valid || !form.controls.faultTolerance.valid">
    <ng-template clrPageTitle>Setup Blockchain and Consortium</ng-template>
    <ng-template clrPageNavTitle>Blockchain & Consortium</ng-template>
    <p>
      All alchemistic believers absorb each other, only closest egos have a stigma.
      Be superior for whoever lures, because each has been synthesised with conclusion.
      Alchemistic dogmas meet most histories.
    </p>
    <div class="form-block">
      <div class="form-group" formGroupName="blockchain">
        <label>Blockchain Type</label>
        <div class="select">
          <select formControlName="type">
            <option value="type1">Type 1</option>
            <option value="type2">Type 2</option>
            <option value="type3">Type 3</option>
          </select>
        </div>
      </div>
      <div class="form-group" formGroupName="faultTolerance">
        <label>Fault Tolerance</label>
        <div class="select">
          <select formControlName="type">
            <option value="type1">Type 1</option>
            <option value="type2">Type 2</option>
            <option value="type3">Type 3</option>
          </select>
        </div>
      </div>
      <div class="form-group" formGroupName="consortium">
        <label>Consortium Name</label>
        <input type="text" formControlName="name" />
      </div>
    </div>
  </clr-wizard-page>

  <clr-wizard-page #orgsPage [clrWizardPageNextDisabled]="!form.controls.organizations.valid">
    <ng-template clrPageTitle>Add Organizations to the Consortium</ng-template>
    <ng-template clrPageNavTitle>Add Organizations</ng-template>
    <p>
      If you listen or remain with a powerful art, suffering acquires you.
      Be playful for whoever exists, because each has been handled with moonlight.
    </p>
    <div [formGroup]="orgForm">
      <div class="form-block">
        <div class="form-group">
          <label>Name</label>
          <input type="text" formControlName="name">
          <button type="button" class="btn btn-primary-outline btn-sm" (click)="addOrg()" [disabled]="!orgForm.valid">Add Organization</button>
        </div>
      </div>
      <table class="table">
        <thead>
        <tr>
          <th class="left">Name</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let org of form?.value.organizations; let i = index">
          <td class="left">
            {{org.name}}
            <div class="float-xs-right table-actions">
              <clr-icon shape="trash" (click)="deleteOrg(i)"></clr-icon>
              <clr-icon shape="pencil" (click)="onEditOrg(i)"></clr-icon>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </clr-wizard-page>

  <clr-wizard-page #usersPage [clrWizardPageNextDisabled]="!form.controls.users.valid">
    <ng-template clrPageTitle>Users & Access</ng-template>
    <ng-template clrPageNavTitle>Add Users & Access</ng-template>
    <p>
      All united cows follow each other, only psychic saints have a sainthood.
      When one develops hypnosis and freedom, one is able to handle awareness.
    </p>
    <div [formGroup]="userForm">
      <div class="form-group row">
        <div class="col-xs-4 col-sm-2">
          <label>First Name</label>
        </div>
        <div class="col-xs-8 col-sm-4">
          <input type="text" formControlName="firstName" class="form-control">
        </div>
        <div class="col-xs-4 col-sm-2">
          <label>Last Name</label>
        </div>
        <div class="col-xs-8 col-sm-4">
          <input type="text" formControlName="lastName" class="form-control">
        </div>
      </div>
      <div class="form-group row">
        <div class="col-xs-4 col-sm-2">
          <label>Email</label>
        </div>
        <div class="col-xs-8 col-sm-4">
          <input type="text" formControlName="email" class="form-control">
        </div>
        <div class="col-xs-4 col-sm-2">
          <label>Organization</label>
        </div>
        <div class="col-xs-8 col-sm-4">
          <div class="select">
            <select name="" formControlName="organization">
              <option *ngFor="let org of form?.value.organizations" value="{{org.name}}">{{org.name}}</option>
            </select>
          </div>
        </div>
      </div>
      <div class="form-group row">
        <div class="col-xs-4 col-sm-2">
          <label>Role</label>
        </div>
        <div class="col-xs-8 col-sm-4">
          <div class="select">
            <select formControlName="role">
              <option value="role1">Role 1</option>
              <option value="role2">Role 2</option>
              <option value="role3">Role 3</option>
            </select>
          </div>
        </div>
      </div>
      <div class="text-right">
        <button class="btn btn-sm btn-primary-outline" type="button" (click)="addUser()" [disabled]="!userForm.valid">Add User</button>
      </div>
    </div>
    <clr-datagrid>
      <clr-dg-column>First Name</clr-dg-column>
      <clr-dg-column>Last Name</clr-dg-column>
      <clr-dg-column>Role</clr-dg-column>
      <clr-dg-row *ngFor="let user of form?.value.users; let i = index">
        <clr-dg-cell>{{user.firstName}}</clr-dg-cell>
        <clr-dg-cell>{{user.lastName}}</clr-dg-cell>
        <clr-dg-cell>
          {{user.role}}
          <div class="float-xs-right table-actions">
            <clr-icon shape="trash" (click)="deleteUser(i)"></clr-icon>
            <clr-icon shape="pencil" (click)="onEditUser(i)"></clr-icon>
          </div>
        </clr-dg-cell>
        <clr-dg-row-detail *clrIfExpanded>
          <table class="table table-noborder mt-0">
            <thead>
            <tr>
              <th class="left border-bottom-0">Email</th>
              <th class="left border-bottom-0">Organization</th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td class="left">{{user.email}}</td>
              <td class="left">{{user.organization}}</td>
            </tr>
            </tbody>
          </table>
        </clr-dg-row-detail>
      </clr-dg-row>
    </clr-datagrid>

  </clr-wizard-page>

  <clr-wizard-page>
    <ng-template clrPageTitle>Review Deployment Setup</ng-template>
    <ng-template clrPageNavTitle>Review</ng-template>
    <p>
      When one loves surrender and career, one is able to witness booda-hood.
      When one fears acceptance and politics, one is able to absorb samadhi.
    </p>

    <h4>
      Chosen Blockchain
      <small class="text-muted ml-1">{{form.value.blockchain.type}}</small>
      <button type="button" class="btn btn-sm btn-link float-xs-right m-0" (click)="jumpTo(blockConsortiumPage)">Edit</button>
    </h4>

    <h4>
      Consortium Setup
      <small class="text-muted ml-1">{{form.value.consortium.name}}</small>
      <button type="button" class="btn btn-sm btn-link float-xs-right m-0" (click)="jumpTo(blockConsortiumPage)">Edit</button>
    </h4>
    <div formGroupName="advancedSettings" class="mt-1">
      <athena-accordion-group>
        <athena-accordion>
          <span class="title">Advanced</span>
          <div class="accordion-body">
            <div class="form-block">
              <div class="form-group">
                <label>Network Name</label>
                <input type="text" formControlName="networkName">
              </div>
              <div class="form-group">
                <label>Number of Nodes</label>
                <input type="number" formControlName="numberOfNodes">
              </div>
              <div class="form-group">
                <label>Public Nodes Regions</label>
                <athena-combobox formControlName="publicNodesRegions"
                                 [items]="publicNodeItems"
                                 [position]="'top-left'"
                                 [multiSelect]="true"
                                 [showTooltip]="false"
                                 [isAddNewAllowed]="false"></athena-combobox>
              </div>
              <div class="form-group">
                <label>Private Node (vCenter/ESX)</label>
                <athena-combobox formControlName="privateNode"
                                 [items]="privateNodeItems"
                                 [position]="'top-left'"
                                 [multiSelect]="true"
                                 [showTooltip]="false"
                                 [isAddNewAllowed]="false"></athena-combobox>
              </div>
            </div>
          </div>
        </athena-accordion>
      </athena-accordion-group>
    </div>
    <h4>
      Organizations
      <button type="button" class="btn btn-sm btn-link float-xs-right m-0" (click)="jumpTo(orgsPage)">Edit</button>
    </h4>
    <table class="table">
      <thead>
      <tr>
        <th class="left">Name</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let org of form?.value.organizations">
        <td class="left">
          {{org.name}}
        </td>
      </tr>
      </tbody>
    </table>
    <h4>
      Users & Access
      <button type="button" class="btn btn-sm btn-link float-xs-right m-0" (click)="jumpTo(usersPage)">Edit</button>
      <clr-datagrid>
        <clr-dg-column>First Name</clr-dg-column>
        <clr-dg-column>Last Name</clr-dg-column>
        <clr-dg-column>Role</clr-dg-column>
        <clr-dg-row *ngFor="let user of form?.value.users">
          <clr-dg-cell>{{user.firstName}}</clr-dg-cell>
          <clr-dg-cell>{{user.lastName}}</clr-dg-cell>
          <clr-dg-cell>{{user.role}}</clr-dg-cell>
          <clr-dg-row-detail *clrIfExpanded>
            <table class="table table-noborder mt-0">
              <thead>
              <tr>
                <th class="left border-bottom-0">Email</th>
                <th class="left border-bottom-0">Organization</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td class="left">{{user.email}}</td>
                <td class="left">{{user.organization}}</td>
              </tr>
              </tbody>
            </table>
          </clr-dg-row-detail>
        </clr-dg-row>
      </clr-datagrid>
    </h4>

  </clr-wizard-page>

</clr-wizard>
</form>
