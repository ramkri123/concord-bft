# Dockerfile to get the Ledger API test tool
#
# Manually update via, e.g.:
# docker build . -f DockerfileLedgerTestTool -t athena-docker-local.artifactory.eng.vmware.com/daml-ledger-api-test-tool:100.13.8
# docker push athena-docker-local.artifactory.eng.vmware.com/daml-ledger-api-test-tool:100.13.8
#
# In artifcatory:
# * <repo-url>/daml-ledger-api-test-tool:100.13.8
# * <repo-url>/daml-ledger-api-test-tool:100.13.12
# * <repo-url>/daml-ledger-api-test-tool:100.13.16
# * <repo-url>/daml-ledger-api-test-tool:100.13.16-java
# * <repo-url>/daml-ledger-api-test-tool:100.13.21
# * <repo-url>/daml-ledger-api-test-tool:100.13.22
# * <repo-url>/daml-ledger-api-test-tool:100.13.23
# * <repo-url>/daml-ledger-api-test-tool:100.13.25
# * <repo-url>/daml-ledger-api-test-tool:100.13.31
# * <repo-url>/daml-ledger-api-test-tool:100.13.37
# * <repo-url>/daml-ledger-api-test-tool:100.13.38
# * <repo-url>/daml-ledger-api-test-tool:100.13.39
# * <repo-url>/daml-ledger-api-test-tool:100.13.40
# * <repo-url>/daml-ledger-api-test-tool:100.13.41

FROM maven:3.6.2-jdk-8-slim

RUN TEST_TOOL_VER='100.13.41' && \
    mvn dependency:get -DrepoUrl=http://repo.maven.apache.org/maven2/ \
      -Dartifact=com.daml.ledger.testtool:ledger-api-test-tool:${TEST_TOOL_VER}:jar \
      -Dtransitive=false -Ddest=/ledger-api-test-tool-${TEST_TOOL_VER}.jar && \
    java -jar /ledger-api-test-tool-${TEST_TOOL_VER}.jar -x localhost:6865
