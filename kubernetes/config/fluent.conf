
<filter $labels(app=helen-prod)>
  @type concat
  multiline_start_regexp /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[user=(?<user>[^ ]*)\])?\s*(\[org=(?<org>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]/
  flush_interval 10
  key log
</filter>

<filter $labels(app=provisioning-service-prod)>
  @type concat
  multiline_start_regexp /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]?/
  multiline_flush_interval 5s
  key log
</filter>

<filter $labels(app=ipam)>
  @type parser
  key_name log
  reserve_data true
  <parse>
   @type regexp
   multiline true
   expression /^\[(?<logtime>[^\]]*)\] \[(?<level>[^\]]*)\] \[(?<thread>[^\]]*)\] \[(?<component>[^\]]*)\]: (?<message>.*)?/
  </parse>
</filter>

<filter $labels(app=config-service-prod)>
  @type concat
  multiline_start_regexp /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]?/
  multiline_flush_interval 5s
  key log
</filter>

<match $labels(app=config-service)>
  @type null
</match>

<match $labels(app=test)>
  @type null
</match>

<match $labels(app=vmbc)>
  @type null
</match>

<match $labels(app=helendb-test)>
  @type null
</match>

<match **>
  @type logzio_buffered
  endpoint_url https://listener.logz.io:8071?token=rXSeKFvLJgMtCPfFiPAapXfMvTRANjgf&type=my_type
  output_include_time true
  output_include_tags true
  buffer_type    file
  buffer_path    /path/to/buffer/file.buf
  flush_interval 10s
  buffer_chunk_limit 1m
</match>