

<filter $labels(app=helen)>
 @type parser
 key_name log
 reserve_data true
 <parse>
   @type regexp
   expression /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[user=(?<user>[^ ]*)\])?\s*(\[org=(?<org>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]$/m
 </parse>
</filter>

<filter $labels(app=provisioning-service)>
 @type parser
 key_name log
 reserve_data true
 <parse>
   @type regexp
   expression /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]$/m
 </parse>
</filter>

<filter $labels(app=ipam)>
 @type parser
 key_name log
 reserve_data true
 <parse>
   @type regexp
   expression /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]$/m
 </parse>
</filter>

<filter $labels(app=config-service-prod)>
 @type parser
 key_name log
 reserve_data true
 <parse>
   @type regexp
   expression /^\[(?<level>[^\]]*)\] \[(?<logtime>[^\]]*)\]\s*(\[thread=(?<thread>[^\]]*)\])?\s*(\[OpID=(?<opid>[^ ]*)\])?\s*(\[function=(?<function>[^ ]*)\])?\s*\[message=(?<message>.*)\]$/m
 </parse>
</filter>

<match $labels(app=test)>
  @type null
</match>

<match **>
  @type logzio_buffered
  endpoint_url https://listener.logz.io:8071?token=AHGNmTZSZhhRCCiuMntqpyOdAiqZnGpy&type=my_type
  output_include_time true
  output_include_tags true
  buffer_type    file
  buffer_path    /path/to/buffer/file.buf
  flush_interval 10s
  buffer_chunk_limit 1m
</match>
